"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{99648:function(ue,U,a){a.r(U),a.d(U,{default:function(){return Y}});var Z=a(43953),l=a.n(Z),b=a(39346),j=a.n(b),k=a(91184),h=a.n(k),C=a(9083),F=a.n(C),m=a(34626);function ie(r){return A.apply(this,arguments)}function A(){return A=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/currentUser",_objectSpread({method:"GET"},t||{})));case 1:case"end":return e.stop()}},r)})),A.apply(this,arguments)}function oe(r){return T.apply(this,arguments)}function T(){return T=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/login/outLogin",_objectSpread({method:"POST"},t||{})));case 1:case"end":return e.stop()}},r)})),T.apply(this,arguments)}function z(r,t){return w.apply(this,arguments)}function w(){return w=h()(l()().mark(function r(t,u){return l()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",(0,m.request)("/online/api/v1/user/login/email",{method:"POST",headers:{"Content-Type":"application/json"},data:{e_mail:t.username,pass:t.password}}));case 1:case"end":return i.stop()}},r)})),w.apply(this,arguments)}function le(r){return x.apply(this,arguments)}function x(){return x=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/notices",_objectSpread({method:"GET"},t||{})));case 1:case"end":return e.stop()}},r)})),x.apply(this,arguments)}function ce(r,t){return R.apply(this,arguments)}function R(){return R=_asyncToGenerator(_regeneratorRuntime().mark(function r(t,u){return _regeneratorRuntime().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",request("/api/rule",_objectSpread({method:"GET",params:_objectSpread({},t)},u||{})));case 1:case"end":return i.stop()}},r)})),R.apply(this,arguments)}function pe(r){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/rule",{method:"POST",data:_objectSpread({method:"update"},t||{})}));case 1:case"end":return e.stop()}},r)})),L.apply(this,arguments)}function de(r){return M.apply(this,arguments)}function M(){return M=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/rule",{method:"POST",data:_objectSpread({method:"post"},t||{})}));case 1:case"end":return e.stop()}},r)})),M.apply(this,arguments)}function ge(r){return P.apply(this,arguments)}function P(){return P=_asyncToGenerator(_regeneratorRuntime().mark(function r(t){return _regeneratorRuntime().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",request("/api/rule",{method:"POST",data:_objectSpread({method:"delete"},t||{})}));case 1:case"end":return e.stop()}},r)})),P.apply(this,arguments)}var E=a(19357),N=a(3294),H=a(3617),G=a(63766),V=a(5251),I=a(2141),W=a(85391),$=a(38497),D=a(2060),J=a(59931),n=a(96469),Q=(0,J.kc)(function(r){var t=r.token;return{action:{marginLeft:"8px",color:"rgba(0, 0, 0, 0.2)",fontSize:"24px",verticalAlign:"middle",cursor:"pointer",transition:"color 0.3s","&:hover":{color:t.colorPrimaryActive}},container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundImage:"url('https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/V-_oS6r-i7wAAAAAAAAAAAAAFl94AQBr')",backgroundSize:"100% 100%"}}}),K=function(t){var u=t.content;return(0,n.jsx)(V.Z,{style:{marginBottom:24},message:u,type:"error",showIcon:!0})},X=function(){var t=(0,$.useState)({}),u=F()(t,2),e=u[0],i=u[1],q=(0,$.useState)("account"),O=F()(q,2),me=O[0],fe=O[1],B=(0,m.useModel)("@@initialState"),v=B.initialState,_=B.setInitialState,ee=Q(),re=ee.styles,y=(0,m.useIntl)(),te=function(){var f=h()(l()().mark(function c(){var p,o;return l()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,v==null||(p=v.fetchUserInfo)===null||p===void 0?void 0:p.call(v);case 2:o=g.sent,o&&(0,D.flushSync)(function(){_(function(S){return j()(j()({},S),{},{currentUser:o})})});case 4:case"end":return g.stop()}},c)}));return function(){return f.apply(this,arguments)}}(),ae=function(){var f=h()(l()().mark(function c(p){var o,d,g,S;return l()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,z(j()({},p));case 3:if(o=s.sent,o.code!==200){s.next=14;break}return localStorage.setItem("token",o.data.access_token),localStorage.setItem("userInfo",JSON.stringify(o.data)),d=y.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),I.ZP.success(d),s.next=11,te();case 11:return g=new URL(window.location.href).searchParams,m.history.push(g.get("redirect")||"/"),s.abrupt("return");case 14:console.log(o),i(o),s.next=23;break;case 18:s.prev=18,s.t0=s.catch(0),S=y.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),console.log(s.t0),I.ZP.error(S);case 23:case"end":return s.stop()}},c,null,[[0,18]])}));return function(p){return f.apply(this,arguments)}}(),ne=e.status,se=e.type;return(0,n.jsxs)("div",{className:re.container,children:[(0,n.jsx)(m.Helmet,{children:(0,n.jsxs)("title",{children:[y.formatMessage({id:"menu.login",defaultMessage:"\u767B\u5F55\u9875"}),"- ",W.Z.title]})}),(0,n.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,n.jsxs)(H.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,n.jsx)("img",{alt:"logo",src:"/sensetime_logo.png",style:{width:"110px",marginLeft:"-10px",marginTop:"4px"}}),title:"\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0CHATBOT",initialValues:{autoLogin:!0},onFinish:function(){var f=h()(l()().mark(function c(p){return l()().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,ae(p);case 2:case"end":return d.stop()}},c)}));return function(c){return f.apply(this,arguments)}}(),children:[ne==="error"&&se==="account"&&(0,n.jsx)(K,{content:y.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF(admin/ant.design)"})}),(0,n.jsxs)("div",{style:{marginTop:"50px"},children:[(0,n.jsx)(G.Z,{name:"username",fieldProps:{size:"large",prefix:(0,n.jsx)(E.Z,{})},placeholder:"\u7528\u6237\u90AE\u7BB1",rules:[{required:!0,message:(0,n.jsx)(m.FormattedMessage,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u90AE\u7BB1!"})}]}),(0,n.jsx)(G.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,n.jsx)(N.Z,{})},placeholder:"\u5BC6\u7801",rules:[{required:!0,message:(0,n.jsx)(m.FormattedMessage,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]})]})]})})]})},Y=X}}]);
